---
title: üÖæÔ∏è4Ô∏è‚É£ Image Build for RZ/V2H Development Board
sidebar_position: 4
---

## Step 1: Download Renesas Verified Linux Package
These are the packages and patch files that you need to download:

**Packages**
- **[RTK0EF0180F03000SJ_linux-src.zip](./packages/RTK0EF0180F03000SJ_linux-src.zip)**


**Patch Files**
- **[0001-recipes-debian-buster-glibc-Update-version-from-2.28.patch](./packages/0001-recipes-debian-buster-glibc-Update-version-from-2.28.patch)**
- **[0001-rz-common-recipes-debian-buster-glibc-update-to-v2.28-10+deb10u4.patch](./packages/0001-rz-common-recipes-debian-buster-glibc-update-to-v2.28-10+deb10u4.patch)**
- **[61835_update_url_gst_common.patch](./packages/61835_update_url_gst_common.patch)**

## Step 2: Copy the Downloaded packages
Enter the `rzv2h` Dev container 

```bash
docker start rzv2h
docker exec -it rzv2h /bin/bash
```

Copy the zip files under `rzv2h` directory and unzip the `.zip` files.

```bash
unzip RTK0EF0180F03000SJ_linux-src.zip
```


## Step 3: Extract the Unzipped files
Create a new directory in your Dev Container and enter it.

```bash
mkdir yocto
cd yocto
```

Extract the `.tar.gz` files.

```bash
tar zxvf ../rzv2h_ai-sdk_yocto_recipe_v3.00.tar.gz
```

List out the files in the working directory to verify the package contents.

```bash
ls -l
```

If the output is as follows, the packages are installed correctly.

```
meta-gplv2
meta-openembedded
meta-renesas
meta-rz-features
meta-virtualization
poky
```


## Step 4: Apply Patch files
Move to the `meta-renesas` directory, apply patch files.

```bash
cd meta-renesas
```

```bash
patch -p1 < ../0001-recipes-debian-buster-glibc-Update-version-from-2.28.patch
```

```bash
patch -p1 < ../0001-rz-common-recipes-debian-buster-glibc-update-to-v2.28-10+deb10u4.patch
```

```bash
patch -d ~/rzv2h/yocto/meta-rz-features/meta-rz-codecs -p1 < ~/rzv2h/yocto/61835_update_url_gst_common.patch
```


## Step 5: Initialise Build Environment for Yocto
Initialize a build using the `oe-init-build-env` script in Poky and set environment variable `TEMPLATECONF` to the below path.

```bash title="dir: ~/home/rzv2h/yocto"
TEMPLATECONF=$PWD/meta-renesas/meta-rzv2h/docs/template/conf/ 
```

```bash 
source poky/oe-init-build-env build
```

Run the following commands to add necessary layers for AI application to build/conf/bblayers.conf (configration file for layers).

```bash title="layer for graphics"
bitbake-layers add-layer ../meta-rz-features/meta-rz-graphics
```

```bash title="layer for drpai"
bitbake-layers add-layer ../meta-rz-features/meta-rz-drpai
```

```bash title="layer for opencva"
bitbake-layers add-layer ../meta-rz-features/meta-rz-opencva
```

```bash title="layer for codecs"
bitbake-layers add-layer ../meta-rz-features/meta-rz-codecs
```

```bash title="add Tesseract Open Source OCR Engine for AI applications"
patch -p1 < ../0001-tesseract.patch
```

## Step 6: Build Images

**For `Weston Image`** :  

Run the following command to build the weston image.
```bash title="dir: ~/home/rzv2h/yocto/build"
MACHINE=rzv2h-evk-ver1 bitbake core-image-weston
```
Run the following command to build cross compiler installer.
```bash title="dir: ~/home/rzv2h/yocto/build"
MACHINE=rzv2h-evk-ver1 bitbake core-image-weston -c populate_sdk
```  


## Step 7: Check Builded Image File
To check the image file,  
go to `~/home/rzv2h/yocto/build/tmp/deploy/images/rzv2h-evk-ver1/`

:::info
image name | file name
--- | ---
core-image-weston | core-image-weston-rzv2h-evk-ver1.wic.gz <br/> core-image-weston-rzv2h-evk-ver1.wic.bmap
core-image-weston sdk | poky-glibc-x86_64-core-image-weston-aarch64-rzv2h-evk-ver1-toolchain-*.sh
:::